<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="page1_stylesheet_Cecilia_Versjon3.css">
    <title>Login page</title>
</head>

<body>

  <div class="grid-container">
      <div id="taskPlannerHeader">MantisClam Taskplanner</div>

      <div id="taskPlannerLogin">Sign in
        <form id="loginForm">
            <input id="loginEmail" type="email" placeholder="Email"/>
            <br>
            <input id="loginPassword" type="password" placeholder="Password" />
            <br>
            <button id="loginBTN" type="submit">Sign in</button>
            <label id="loginId"></label>
          </form>
      </div>
      <div id="taskPlannerCreate">Sign up
        <form id="CreateForm">
            <input id="createEmail" type="email" placeholder="Email"/>
            <br>
            <input id="createPassword" type="password" placeholder="Password" />
            <br>
            <button id="createBTN" type="submit">Create new user</button>
            <label id="createId"></label>
          </form>
      </div>
  </div>

    
</body>

<script>

    //Login -------------------------------------------------------------------------------------------------------------------------------------


        const emailLogin = document.getElementById("loginEmail");
        const passwordLogin = document.getElementById("loginPassword");

       let credentials = null;

       loginForm.onsubmit = submit;

        function submit (evt) {
            evt.preventDefault();

            let username = emailLogin.value
            let password = passwordLogin.value

            credentials = "Basic " + window.btoa(`${username}:${password}`)

            let config = {
                method: "GET",
                headers: {
                    "content-type": "application/json",
                    "authorization": credentials
                }
            }

            fetch(`/user`, config).then(resp => {
                console.log(resp.status);
            })
            

        
        }

// ------------------------------------------------------------------------------------------------------------------------------------------------

//Create ------------------------------------------------------------------------------------------------------------------------------------
    
        const emailInput = document.getElementById("createEmail");
        const passwordInput = document.getElementById("createPassword");

        document.getElementById("createBTN").onclick = function (evt) {

            if (emailInput.value.length < 3 && passwordInput.value.length < 3) {
                alert("At least 3 characters.");
                return
            }

            let body = {
                username: emailInput.value,
                password: passwordInput.value
            }
            let config = {
                method: "POST",
                headers: {
                    "content-type": "application/json",
                    "authorization": credentials
                },
                body: JSON.stringify(body)
            }

            fetch("/user", config).then(resp => {
                console.log(resp.status);
            })


        }

// ---------------------------------------------------------------------------------------------------------------------------------------------------------------------



</script>


</html>